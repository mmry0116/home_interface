{"version":3,"file":"index.min.js","sources":["../src/buffer.js","../src/env.js","../src/error.js","../src/logger.js","../src/utils.js","../src/mse.js","../src/net/types.js","../src/net/error.js","../src/is.js","../src/net/helper.js","../src/event.js","../../../node_modules/eventemitter3/index.js","../src/net/fetch.js","../src/net/xhr.js","../src/net/task.js","../src/streaming-helper.js","../src/net/index.js","../src/net/config.js","../src/services/gap.js","../src/services/sei.js","../src/services/bandwidth.js","../src/services/stats.js","../src/index.umd.js"],"sourcesContent":["export class Buffer {\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static start (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n    // Edge bug: https://bit.ly/2JYLPeB\n    if (buf.length === 1 && buf.start(0) < 0) return 0\n\n    return buf.start(0)\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static end (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n\n    return buf.end(buf.length - 1)\n  }\n\n  /**\n   * @param {{buffered?: TimeRanges}} b\n   * @returns {TimeRanges | void}\n   */\n  static get (b) {\n    if (!b) return\n    try {\n      return b.buffered\n    } catch (error) {\n      // ignore\n    }\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {[number,number][]}\n   */\n  static buffers (buf, maxHole) {\n    if (!buf || !buf.length) return []\n\n    const buffers = []\n    for (let i = 0, l = buf.length; i < l; i++) {\n      const bufLen = buffers.length\n      if (!bufLen || !maxHole) {\n        buffers.push([buf.start(i), buf.end(i)])\n      } else {\n        const last = buffers[bufLen - 1]\n        const lastEnd = last[1]\n        const start = buf.start(i)\n        if (start - lastEnd <= maxHole) {\n          const end = buf.end(i)\n          if (end > lastEnd) {\n            last[1] = end\n          }\n        } else {\n          buffers.push([buf.start(i), buf.end(i)])\n        }\n      }\n    }\n    return buffers\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {{buffers:[number,number][],length:number}}\n   */\n  static totalLength (buffers) {\n    if (!buffers || !buffers.length) return 0\n    return buffers.reduce((a, c) => (a += (c[1] - c[0])), 0)\n  }\n\n  /**\n   *\n   * @param {TimeRanges} buf\n   * @param {number} [pos=0]\n   * @param {number} [maxHole=0]\n   * @returns {{start:number,end:number,buffers:[number,number][],remaining:number,index?:number,nextStart?:number,nextEnd?:number,prevStart?:number,prevEnd?:number}}\n   */\n  static info (buf, pos = 0, maxHole = 0) {\n    if (!buf || !buf.length) return { start: 0, end: 0, buffers: [] }\n\n    let start = 0\n    let end = 0\n    let index = 0\n    let nextStart = 0\n    let nextEnd = 0\n    let prevStart = 0\n    let prevEnd = 0\n    const buffers = Buffer.buffers(buf, maxHole)\n\n    for (let i = 0, l = buffers.length; i < l; i++) {\n      const item = buffers[i]\n      if (pos + maxHole >= item[0] && pos <= item[1]) {\n        start = item[0]\n        end = item[1]\n        index = i\n      } else if (pos + maxHole < item[0]) {\n        nextStart = item[0]\n        nextEnd = item[1]\n        break\n      } else if (pos + maxHole > item[1]) {\n        prevStart = item[0]\n        prevEnd = item[1]\n      }\n    }\n\n    return {\n      start,\n      end,\n      index,\n      buffers,\n      nextStart,\n      nextEnd,\n      prevStart,\n      prevEnd,\n      currentTime: pos,\n      behind: pos - start,\n      remaining: end ? end - pos : 0,\n      length: Buffer.totalLength && Buffer.totalLength(buffers)\n    }\n  }\n}\n","export const isBrowser = typeof window !== 'undefined'\n","export const ERR = {\n  MANIFEST: 'manifest',\n  NETWORK: 'network',\n  NETWORK_TIMEOUT: 'network_timeout',\n  NETWORK_FORBIDDEN:'network_forbidden',\n  NETWORK_NOTFOUND: 'network_notfound',\n  NETWROK_RANGE_NOT_SATISFIABLE:'network_range_not_satisfiable',\n  DEMUX: 'demux',\n  REMUX: 'remux',\n  MEDIA: 'media',\n  DRM: 'drm',\n  OTHER: 'other',\n  RUNTIME:'runtime',\n\n  SUB_TYPES: {\n    FLV: 'FLV',\n    HLS: 'HLS',\n    MP4: 'MP4',\n    FMP4: 'FMP4',\n    MSE_ADD_SB: 'MSE_ADD_SB',\n    MSE_APPEND_BUFFER: 'MSE_APPEND_BUFFER',\n    MSE_OTHER: 'MSE_OTHER',\n    MSE_FULL: 'MSE_FULL',\n    OPTION: 'OPTION',\n    DASH:'DASH',\n    LICENSE:'LICENSE',\n    CUSTOM_LICENSE:'CUSTOM_LICENSE',\n    MSE_HIJACK:'MSE_HIJACK',\n    EME_HIJACK:'EME_HIJACK',\n    SIDX:'SIDX',\n    NO_CANPLAY_ERROR:'NO_CANPLAY_ERROR',\n    BUFFERBREAK_ERROR:'BUFFERBREAK_ERROR',\n    WAITING_TIMEOUT_ERROR: 'WAITING_TIMEOUT_ERROR',\n    MEDIA_ERR_ABORTED:'MEDIA_ERR_ABORTED',\n    MEDIA_ERR_NETWORK:'MEDIA_ERR_NETWORK',\n    MEDIA_ERR_DECODE:'MEDIA_ERR_DECODE',\n    MEDIA_ERR_SRC_NOT_SUPPORTED:'MEDIA_ERR_SRC_NOT_SUPPORTED',\n    MEDIA_ERR_CODEC_NOT_SUPPORTED:'MEDIA_ERR_CODEC_NOT_SUPPORTED',\n    MEDIA_ERR_URL_EMPTY:'MEDIA_ERR_URL_EMPTY'\n  }\n}\n\nexport const ERR_CODE = {\n  [ERR.MANIFEST]: {\n    HLS: 1100,\n    DASH:1200\n  },\n  [ERR.NETWORK]: 2100,\n  [ERR.NETWORK_TIMEOUT]: 2101,\n  [ERR.NETWORK_FORBIDDEN]:2103,\n  [ERR.NETWORK_NOTFOUND]:2104,\n  [ERR.NETWROK_RANGE_NOT_SATISFIABLE]:2116,\n  [ERR.DEMUX]: {\n    FLV: 3100,\n    HLS: 3200,\n    MP4: 3300,\n    FMP4: 3400,\n    SIDX: 3410\n  },\n  [ERR.REMUX]: {\n    FMP4: 4100,\n    MP4: 4200\n  },\n  [ERR.MEDIA]: {\n    MEDIA_ERR_ABORTED: 5101,\n    MEDIA_ERR_NETWORK: 5102,\n    MEDIA_ERR_DECODE: 5103,\n    MEDIA_ERR_SRC_NOT_SUPPORTED: 5104,\n    MEDIA_ERR_CODEC_NOT_SUPPORTED: 5105,\n    MEDIA_ERR_URL_EMPTY: 5106,\n    MSE_ADD_SB: 5200,\n    MSE_APPEND_BUFFER: 5201,\n    MSE_OTHER: 5202,\n    MSE_FULL: 5203,\n    MSE_HIJACK:5204,\n    EME_HIJACK:5301\n  },\n  [ERR.DRM]:{\n    LICENSE:7100,\n    CUSTOM_LICENSE:7200\n  },\n  [ERR.OTHER]: 8000,\n  [ERR.RUNTIME]:{\n    NO_CANPLAY_ERROR:9001,\n    BUFFERBREAK_ERROR:9002,\n    WAITING_TIMEOUT_ERROR:9003\n  }\n}\n\n\n\nexport class StreamingError extends Error {\n  constructor (type, subType, origin, payload, msg) {\n    super(msg || origin?.message)\n    this.errorType = type === ERR.NETWORK_TIMEOUT ? ERR.NETWORK : type\n    this.originError = origin\n    this.ext = payload\n    this.errorCode = ERR_CODE[type][subType] || ERR_CODE[type]\n    this.errorMessage = this.message\n    if (!this.errorCode) {\n      this.errorType = ERR.OTHER\n      this.errorCode = ERR_CODE[this.errorType]\n    }\n  }\n\n  static create (type, subType, origin, payload, msg) {\n    if (type instanceof StreamingError) {\n      return type\n    } else if (type instanceof Error) {\n      origin = type\n      type = ''\n    }\n\n    if (!type) type = ERR.OTHER\n\n    return new StreamingError(type, subType, origin, payload, msg)\n  }\n\n  static network (error) {\n    return new StreamingError(\n      error?.isTimeout ? ERR.NETWORK_TIMEOUT : ERR.NETWORK,\n      null,\n      error instanceof Error ? error : null,\n      {\n        url: error?.url,\n        response: error?.response,\n        httpCode: error?.response?.status\n      }\n    )\n  }\n}\n","\nexport const LogCacheLevel = {\n  'DEBUG': 1,\n  'LOG': 2,\n  'WARN': 3,\n  'ERROR': 4\n}\nconst LOG_MAX_SIZE = 200 * 1024\nconst SIMPLE_TYPE = ['Boolean', 'Number' ,'String', 'Undefined','Null', 'Date','Object']\nexport class Logger {\n  constructor (name,config) {\n    this.name = name || ''\n    this._prefix = `[${this.name}]`\n    this.logCacheLevel = config?.logCacheLevel || 3\n    this.logMaxSize = config?.logMaxSize || LOG_MAX_SIZE\n    this.logSize = 0\n    this.logTextArray = []\n  }\n\n  debug (...args) {\n    this.logCache(LogCacheLevel.DEBUG,...args)\n    if (Logger.disabled) return\n    console.debug(this._prefix, nowTime(), ...args)\n  }\n\n  log (...args) {\n    this.logCache(LogCacheLevel.LOG,...args)\n    if (Logger.disabled) return\n    console.log(this._prefix, nowTime(), ...args)\n  }\n\n  warn (...args) {\n    this.logCache(LogCacheLevel.WARN,...args)\n    if (Logger.disabled) return\n    console.warn(this._prefix, nowTime(), ...args)\n  }\n\n  error (...args) {\n    this.logCache(LogCacheLevel.ERROR,...args)\n    if (Logger.disabled) return\n    console.error(this._prefix, nowTime(), ...args)\n  }\n\n  logCache (logCacheLevel, ...logText) {\n    if (logCacheLevel < this.logCacheLevel) return\n    let text = ''\n    try {\n      const finLogText = logText.map( item => logable(item))\n      text = this._prefix + nowTime() + (JSON.stringify(finLogText))\n    } catch (e) {\n      return\n    }\n    if (logCacheLevel >= this.logCacheLevel) {\n      this.logSize += text.length\n      this.logTextArray.push(text)\n    }\n    if (this.logSize > this.logMaxSize) {\n      const delLog = this.logTextArray.shift()\n      this.logSize -= delLog.length\n    }\n  }\n\n  getLogCache () {\n    const logText = this.logTextArray.join('\\n')\n    this.reset()\n    return logText\n  }\n\n  reset () {\n    this.logTextArray = []\n    this.logSize = 0\n  }\n\n  table (...args) {\n    if (Logger.disabled) return\n    console.group(this._prefix)\n    console.table(...args)\n    console.groupEnd()\n  }\n\n  static disabled = true\n\n  static enable () {\n    Logger.disabled = false\n  }\n\n  static disable () {\n    Logger.disabled = true\n  }\n\n  setLogLevel (val) {\n    this.logCacheLevel = val\n  }\n}\nfunction nowTime () {\n  return new Date().toLocaleString()\n}\n\nfunction reduceDepth (val) {\n  if (typeof val !== 'object') {\n    return val\n  }\n  const objType = Object.prototype.toString.call(val).slice(8, -1)\n  switch (objType) {\n    case 'Array':\n    case 'Uint8Array':\n    case 'ArrayBuffer':\n\n      return objType + '[' + val.length + ']'\n    case 'Object':\n      return '{}'\n    default:\n      return objType\n  }\n}\n\nfunction logable (obj, maxDepth, depth) {\n  if (!depth) depth = 1\n  if (!maxDepth) maxDepth = 2\n  const result = {}\n\n  if (!obj || typeof obj !== 'object') {\n    return obj\n  }\n\n  const objType = Object.prototype.toString.call(obj).slice(8, -1)\n  if (!SIMPLE_TYPE.includes(objType)) {\n    return objType\n  }\n\n  if (depth > maxDepth) {\n    return undefined\n  }\n\n\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (depth === maxDepth) {\n        result[key] = reduceDepth(obj[key])\n      } else if (typeof obj[key] === 'object') {\n        result[key] = logable(obj[key], maxDepth, depth + 1)\n      } else {\n        result[key] = obj[key]\n      }\n    }\n  }\n  return result\n}\n\n","export function createPublicPromise () {\n  let res, rej\n  const promise = new Promise((resolve, reject) => {\n    res = resolve\n    rej = reject\n  })\n  promise.used = false\n  promise.resolve = (...args) => {\n    promise.used = true\n    return res(...args)\n  }\n  promise.reject = (...args) => {\n    promise.used = true\n    return rej(...args)\n  }\n  return promise\n}\n\nexport function nowTime () {\n  try {\n    return parseInt(performance.now(), 10)\n  } catch (e) {\n    return new Date().getTime()\n  }\n}\n\n\nexport const SafeJSON = {\n  stringify (obj) {\n    try {\n      return JSON.stringify(obj)\n    } catch (e) {\n      return ''\n    }\n  },\n  parse (obj) {\n    try {\n      return JSON.parse(obj)\n    } catch (e) {\n      return undefined\n    }\n  }\n}\n","/* eslint-disable no-undef */\nimport { Buffer } from './buffer'\nimport { isBrowser } from './env'\nimport { ERR, StreamingError } from './error'\nimport { Logger } from './logger'\nimport { createPublicPromise, nowTime, SafeJSON } from './utils'\n\nfunction getMediaSource (preferMMS = true) {\n  try {\n    if (!isBrowser) return null\n\n    if (preferMMS && typeof ManagedMediaSource !== 'undefined') return ManagedMediaSource\n\n    return window.MediaSource\n  } catch (e) {}\n}\n\nfunction isMMS (mediaSource) {\n  return /ManagedMediaSource/gi.test(Object.prototype.toString.call(mediaSource))\n}\n\n/**\n * @param {TimeRanges} buffered\n */\nfunction getTimeRanges (buffered) {\n  const ranges = []\n\n  if (buffered instanceof TimeRanges) {\n    for (let i = 0; i < buffered.length; i++) {\n      ranges.push({\n        start: buffered.start(i),\n        end: buffered.end(i)\n      })\n    }\n  }\n  return ranges\n}\n\n/** @enum {string} */\nexport const MSEErrorType = {\n  UPDATE_ERROR: 'updateError'\n}\n\nconst OP_NAME = {\n  APPEND: 'appendBuffer',\n  REMOVE: 'removeBuffer',\n  UPDATE_DURATION:'updateDuration'\n}\n\nexport class MSEError extends Error {\n  /**\n   * @param {MSEErrorType} type\n   * @param {any} [msg]\n   */\n  constructor (type, msg) {\n    super(msg || type)\n    this.type = type\n    this.msg = msg\n  }\n}\n\nexport class MSE {\n  static VIDEO = 'video'\n\n  static AUDIO = 'audio'\n\n  /**\n   * @param {string} [mime='video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"']\n   * @param { boolean} preferMMS\n   * @returns {boolean}\n   */\n  static isSupported (mime = 'video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"') {\n    const MediaSource = getMediaSource()\n    if (!MediaSource) return false\n    try {\n      return MediaSource.isTypeSupported(mime)\n    } catch (error) {\n      this._logger.error(mime, error)\n      return false\n    }\n  }\n\n  static isMMSOnly () {\n    return typeof ManagedMediaSource !== 'undefined' && typeof MediaSource === 'undefined'\n  }\n\n  /** @type { HTMLMediaElement | null } */\n  media = null\n\n  /** @type { MediaSource | null } */\n  mediaSource = null\n\n  _openPromise = createPublicPromise()\n\n  _queue = Object.create(null)\n\n  _sourceBuffer = Object.create(null)\n\n  _mseFullFlag = {}\n\n  _st = 0\n\n  _opst = 0\n\n  _logger = null\n\n  _config = null\n  _url = null\n\n\n  static getDefaultConfig () {\n    return {\n      openLog: false,\n      preferMMS: false\n    }\n  }\n\n  /**\n   * @param {HTMLMediaElement} [media]\n   */\n  constructor (media, config) {\n    this._config = Object.assign(MSE.getDefaultConfig(), config)\n    if (media) this.bindMedia(media)\n    this._logger = new Logger('MSE')\n    if (this._config.openLog) {\n      Logger.enable()\n    }\n  }\n\n  get isOpened () {\n    return this.mediaSource?.readyState === 'open'\n  }\n\n  get hasOpTasks () {\n    let flag = false\n    Object.keys(this._queue).forEach(k => {\n      const queue = this._queue[k]\n      if (Array.isArray(queue)) {\n        flag ||= queue.length > 0\n      }\n    })\n    return flag\n  }\n\n  get url () {\n    return this._url\n  }\n\n  get duration () {\n    return this.mediaSource?.duration || -1\n  }\n\n  get isEnded () {\n    return this.mediaSource ? this.mediaSource.readyState === 'ended' : false\n  }\n\n  get streaming () {\n    return isMMS(this.mediaSource) ? this.mediaSource.streaming : true\n  }\n\n  isFull (type) {\n    return type ? this._mseFullFlag[type] : this._mseFullFlag[MSE.VIDEO]\n  }\n\n  /**\n   * @param { number } duration\n   * @return { Promise }\n   */\n  updateDuration (duration) {\n    const isReduceDuration = this.mediaSource && this.mediaSource.duration > duration\n    if (this.mediaSource && this.mediaSource.duration > duration) {\n      let bufferEnd = 0\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          bufferEnd = Math.max(this.bufferEnd(k) || 0, bufferEnd)\n        } catch (error) {\n          // ignore\n        }\n      })\n      if (duration < bufferEnd) {\n        // 设置值比bufferEnd值小，会导致异常\n        return Promise.resolve()\n      }\n    }\n\n    return this._enqueueBlockingOp(() => {\n      if (this.isEnded) {\n        this._logger.debug('setDuration but ended')\n        return\n      }\n      if (this.mediaSource) {\n        this.mediaSource.duration = duration\n        this._logger.debug('setDuration', duration)\n      }\n    }, OP_NAME.UPDATE_DURATION, {isReduceDuration})\n  }\n\n  /** @return { Promise } */\n  open () {\n    if (this._openPromise.used && !this.isOpened && this.mediaSource) {\n      const ms = this.mediaSource\n      const onOpen = () => {\n        const costTime = nowTime() - this._st\n        this._logger.debug('sourceopen', costTime)\n        ms.removeEventListener('sourceopen', onOpen)\n        this._openPromise.resolve({costtime: costTime})\n      }\n      ms.addEventListener('sourceopen', onOpen)\n      this._openPromise = createPublicPromise()\n    }\n\n    return this._openPromise\n  }\n\n  /**\n   * @private\n   */\n  _onStartStreaming = () => {\n    this._logger.debug('startstreaming')\n  }\n\n  /**\n   * @private\n   */\n  _onEndStreaming = () => {\n    this._logger.debug('endstreaming')\n  }\n\n  /**\n   * @param { HTMLMediaElement } media\n   * @return { Promise }\n   */\n  async bindMedia (media) {\n    if (this.mediaSource || this.media) await this.unbindMedia()\n\n    const MediaSource = getMediaSource(this._config.preferMMS)\n\n    if (!media || !MediaSource) throw new Error('Param media or MediaSource does not exist')\n    this.media = media\n    const ms = this.mediaSource = new MediaSource()\n    const useMMS = isMMS(ms)\n    this._st = nowTime()\n\n    const onOpen = () => {\n      const costTime = nowTime() - this._st\n      this._logger.debug('sourceopen')\n      ms.removeEventListener('sourceopen', onOpen)\n      URL.revokeObjectURL(media.src)\n      this._openPromise.resolve({costtime: costTime})\n    }\n    ms.addEventListener('sourceopen', onOpen)\n    if (useMMS) {\n      ms.addEventListener('startstreaming', this._onStartStreaming)\n      ms.addEventListener('endstreaming', this._onEndStreaming)\n    }\n\n    this._url = URL.createObjectURL(ms)\n    media.src = this._url\n    media.disableRemotePlayback = useMMS\n\n    return this._openPromise\n  }\n\n  /** @return { Promise } */\n  async unbindMedia () {\n    if (!this._openPromise.used) this._openPromise.resolve()\n    const ms = this.mediaSource\n\n    if (ms) {\n      Object.keys(this._queue).forEach((t) => {\n        const queue = this._queue[t]\n        if (queue) {\n          queue.forEach(x => x.promise?.resolve?.())\n        }\n      })\n\n      const hasMetadata = !!this.media && this.media.readyState >= 1\n      const mseOpen = ms.readyState === 'open'\n\n      if (hasMetadata && mseOpen) {\n        try {\n          ms.endOfStream()\n        } catch (error) {\n          // ignore\n        }\n      }\n\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          ms.removeSourceBuffer(this._sourceBuffer[k])\n        } catch (error) {\n          // ignore\n        }\n      })\n\n      if (isMMS(ms)) {\n        ms.removeEventListener('startstreaming', this._onStartStreaming)\n        ms.removeEventListener('endstreaming', this._onEndStreaming)\n      }\n    }\n\n    if (this.media) {\n      this.media.disableRemotePlayback = false\n      this.media.removeAttribute('src')\n      try {\n        this.media.load()\n      } catch (error) {\n        // ignore\n      }\n      this.media = null\n    }\n\n    this.mediaSource = null\n    this._openPromise = createPublicPromise()\n    this._queue = Object.create(null)\n    this._sourceBuffer = Object.create(null)\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   */\n  createSource (type, mimeType) {\n    if (this._sourceBuffer[type] || !this.mediaSource) return\n    let sb\n    try {\n      sb = this._sourceBuffer[type] = this.mediaSource.addSourceBuffer(mimeType)\n    } catch (error) {\n      throw new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_ADD_SB, error)\n    }\n    sb.mimeType = mimeType\n    sb.addEventListener('updateend', this._onSBUpdateEnd.bind(this, type))\n    sb.addEventListener('error', this._onSBUpdateError.bind(this, type))\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  changeType (type, mimeType) {\n    const sb = this._sourceBuffer[type]\n    if (!this.mediaSource || !sb || sb.mimeType === mimeType) return Promise.resolve()\n\n    if (typeof sb.changeType !== 'function') return Promise.reject()\n\n    return this._enqueueOp(type, () => {\n      sb.changeType(mimeType)\n      sb.mimeType = mimeType\n      this._onSBUpdateEnd(type)\n    }, 'changeType', {mimeType})\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  createOrChangeSource (type, mimeType) {\n    this.createSource(type, mimeType)\n    return this.changeType(type, mimeType)\n  }\n\n  /**\n   * @param { string } type\n   * @param { BufferSource } buffer\n   * @return { Promise }\n   */\n  append (type, buffer, context) {\n    if (!buffer || !buffer.byteLength) {\n      return Promise.resolve()\n    }\n\n    if (!this._sourceBuffer[type]) return Promise.resolve()\n\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      this._logger.debug('MSE APPEND START', context)\n      this._opst = nowTime()\n      this._sourceBuffer[type]?.appendBuffer(buffer)\n    }, OP_NAME.APPEND, context)\n\n  }\n\n  /**\n   * @param { string } type\n   * @param { number } startTime\n   * @param { number } endTime\n   * @return { Promise }\n   */\n  remove (type, startTime, endTime, context) {\n    // if (Object.keys(this._sourceBuffer).length === 1) return Promise.resolve()\n    let isInsertHead = false\n    if (this._mseFullFlag[type]) {\n      isInsertHead = true\n    }\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      const sb = this._sourceBuffer[type]\n      if (startTime >= endTime || !sb) {\n        this._onSBUpdateEnd(type)\n        return\n      }\n      this._opst = nowTime()\n      this._logger.debug('MSE REMOVE START', type, startTime, endTime, context)\n      sb.remove(startTime, endTime)\n    }, OP_NAME.REMOVE, context, isInsertHead)\n  }\n\n  clearBuffer (startTime, endTime) {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      p = this.remove(k, startTime, endTime)\n    })\n    return p || Promise.resolve()\n  }\n\n  clearAllBuffer () {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      const sb = this._sourceBuffer[k]\n      p = this.remove(k, 0, Buffer.end(Buffer.get(sb)))\n    })\n    return p\n  }\n\n  clearOpQueues (type, allClear) {\n    this._logger.debug('MSE clearOpQueue START')\n    const queue = this._queue[type]\n    if (allClear && queue) {\n      this._queue[type] = []\n      return\n    }\n    if (!queue || !queue[type] || queue.length < 5) return\n    const initQueue = []\n    queue.forEach(op => {\n      if (op.context && op.context.isinit) {\n        initQueue.push(op)\n      }\n    })\n    this._queue[type] = queue.slice(0, 2)\n    initQueue.length > 0 && this._queue[type].push(...initQueue)\n  }\n\n  /**\n   * @param {EndOfStreamError} [reason]\n   * @returns {Promise}\n   */\n  endOfStream (reason) {\n    if (!this.mediaSource || this.mediaSource.readyState !== 'open') return Promise.resolve()\n    return this._enqueueBlockingOp(() => {\n      const ms = this.mediaSource\n      if (!ms || ms.readyState !== 'open') return\n      this._logger.debug('MSE endOfStream START')\n      if (reason) {\n        ms.endOfStream(reason)\n      } else {\n        ms.endOfStream()\n      }\n    }, 'endOfStream')\n  }\n\n  setLiveSeekableRange (start, end) {\n    const ms = this.mediaSource\n    if (start < 0 || end < start || !ms?.setLiveSeekableRange || ms.readyState !== 'open') return\n    ms.setLiveSeekableRange(start, end)\n  }\n\n  /**\n   * @param {string} type\n   * @returns {?SourceBuffer}\n   */\n  getSourceBuffer (type) {\n    return this._sourceBuffer[type]\n  }\n\n  /**\n   * @param { string } type\n   * @return { TimeRanges | void }\n   */\n  buffered (type) {\n    return Buffer.get(this._sourceBuffer[type])\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferStart (type) {\n    return Buffer.start(this.buffered(type))\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferEnd (type) {\n    return Buffer.end(this.buffered(type))\n  }\n\n  _enqueueOp (type, exec, opName, context, isInsertHead) {\n    if (!this.mediaSource) return Promise.resolve()\n    const queue = this._queue[type] = this._queue[type] || []\n    const op = {\n      exec,\n      promise: createPublicPromise(),\n      opName,\n      context\n    }\n\n    if (isInsertHead) {\n      queue.splice(0, 0, op)\n      this._mseFullFlag[type] = false\n      this._startQueue(type)\n    } else {\n      queue.push(op)\n    }\n\n    if (this.isOpened || this.isEnded) {\n      if (queue.length === 1) {\n        this._startQueue(type)\n      }\n    } else {\n      this._openPromise.then(() => {\n        if (queue.length === 1) {\n          this._startQueue(type)\n        }\n      })\n    }\n\n\n    return op.promise\n  }\n\n  async _enqueueBlockingOp (exec, opName, context) {\n    if (!this.mediaSource) return Promise.resolve()\n    const types = Object.keys(this._sourceBuffer)\n    if (!types.length) {\n      return exec()\n    }\n\n    const waiters = []\n    types.forEach(t => {\n      const queue = this._queue[t]\n      const prom = createPublicPromise()\n      waiters.push(prom)\n      queue.push({exec: () => {\n        prom.resolve()}, promise: prom, opName, context})\n      if (queue.length === 1) {\n        this._startQueue(t)\n      }\n    })\n\n    return Promise.all(waiters).then(() => {\n      try {\n        return exec()\n      } finally {\n        types.forEach(t => {\n          const queue = this._queue[t]\n          const sb = this._sourceBuffer[t]\n          queue?.shift()\n          if (!sb || !sb.updating) {\n            this._startQueue(t)\n          }\n        })\n      }\n    })\n  }\n\n  _startQueue (type) {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op && !this._mseFullFlag[type]) {\n        try {\n          op.exec()\n        } catch (error) {\n          if (error && error.message && error.message.indexOf('SourceBuffer is full') >= 0) {\n            this._mseFullFlag[type] = true\n            this._logger.error('[MSE error],  context,', op.context, ' ,name,', op.opName, ',err,SourceBuffer is full')\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_FULL, error))\n          } else {\n            this._logger.error(error)\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_OTHER, error))\n            queue.shift()\n            this._startQueue(type)\n          }\n        }\n      }\n    }\n  }\n\n  _onSBUpdateEnd = (type) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (!(op?.opName === OP_NAME.UPDATE_DURATION)) {\n        queue.shift()\n      }\n      if (op) {\n        const costtime = nowTime() - this._opst\n        this._logger.debug(`UpdateEnd(${type}/${op.opName})`, SafeJSON.stringify(getTimeRanges(this._sourceBuffer[type]?.buffered)), costtime, op.context)\n        op.promise.resolve({name: op.opName, context: op.context, costtime})\n        this._startQueue(type)\n      }\n    }\n  }\n\n  _onSBUpdateError = (type, event) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op) {\n        this._logger.error('UpdateError', type, op.opName, op.context)\n        op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_APPEND_BUFFER, event))\n        // Do not shift from queue, 'updateend' event will fire next\n      }\n    }\n  }\n\n  setTimeoffset (type, timestampOffset, context) {\n    return this._enqueueOp(type, () => {\n      if (timestampOffset < 0) {\n        timestampOffset += 0.001\n      }\n      this._sourceBuffer[type].timestampOffset = timestampOffset\n      this._onSBUpdateEnd(type)\n    }, 'setTimeoffset', context)\n  }\n\n  /** *重置decode时间戳 */\n  abort (type, context) {\n    if (!this.isOpened) {\n      return Promise.resolve()\n    }\n    return this._enqueueOp(type, () => {\n      this._sourceBuffer[type].abort()\n      this._onSBUpdateEnd(type)\n    }, 'abort', context)\n  }\n}\n","export const LoaderType = {\n  FETCH: 'fetch',\n  XHR: 'xhr'\n}\n\nexport const ResponseType = {\n  ARRAY_BUFFER: 'arraybuffer',\n  TEXT: 'text',\n  JSON: 'json'\n}\n","import { LoaderType } from './types'\n\nexport class NetError extends Error {\n  retryCount = 0\n  isTimeout = false\n  loaderType = LoaderType.FETCH\n  startTime = 0\n  endTime = 0\n  options = {}\n\n  constructor (url, request, response, msg) {\n    super(msg)\n    this.url = url\n    this.request = request\n    this.response = response\n  }\n}\n","const toString = Object.prototype.toString\n\nexport function isObject (a) {\n  return a !== null && typeof a === 'object'\n}\n\nexport function isPlainObject (val) {\n  if (toString.call(val) !== '[object Object]') {\n    return false\n  }\n\n  const prototype = Object.getPrototypeOf(val)\n  return prototype === null || prototype === Object.prototype\n}\n\nexport function isDate (a) {\n  return toString.call(a) === '[object Date]'\n}\n\nexport function isNumber (n) {\n  return typeof n === 'number' && !Number.isNaN(n)\n}\n","import { isDate, isObject } from '../is'\n\nexport function getRangeValue (value) {\n  if (!value || value[0] === null || value[0] === undefined || (value[0] === 0 && (value[1] === null || value[1] === undefined))) {\n    return\n  }\n  let ret = 'bytes=' + value[0] + '-'\n  if (value[1]) ret += value[1]\n  return ret\n}\n\nfunction encode (val) {\n  return encodeURIComponent(val)\n    .replace(/%3A/gi, ':')\n    .replace(/%24/g, '$')\n    .replace(/%2C/gi, ',')\n    .replace(/%20/g, '+')\n    .replace(/%5B/gi, '[')\n    .replace(/%5D/gi, ']')\n}\n\nexport function setUrlParams (url, params) {\n  if (!url) return\n  if (!params) return url\n  let v\n  const str = Object.keys(params).map(k => {\n    v = params[k]\n    if (v === null || v === undefined) return\n    if (Array.isArray(v)) {\n      k = k + '[]'\n    } else {\n      v = [v]\n    }\n\n    return v.map(x => {\n      if (isDate(x)) {\n        x = x.toISOString()\n      } else if (isObject(x)) {\n        x = JSON.stringify(x)\n      }\n      return `${encode(k)}=${encode(x)}`\n    }).join('&')\n  }).filter(Boolean).join('&')\n\n  if (str) {\n    const hashIndex = url.indexOf('#')\n    if (hashIndex !== -1) {\n      url = url.slice(0, hashIndex)\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + str\n  }\n\n  return url\n}\n\nexport function createResponse (\n  data,\n  done,\n  response,\n  contentLength,\n  age,\n  startTime,\n  firstByteTime,\n  index,\n  range,\n  vid,\n  priOptions\n) {\n  age = (age !== null && age !== undefined) ? parseFloat(age) : null\n  contentLength = parseInt(contentLength || '0', 10)\n  if (Number.isNaN(contentLength)) contentLength = 0\n  const options = { range, vid, index, contentLength, age, startTime, firstByteTime, endTime: Date.now(), priOptions }\n  return { data, done, options, response }\n}\n\nexport function calculateSpeed (byteLen, millisec) {\n  return Math.round(byteLen * 8 * 1000 / millisec / 1024)\n}\n","export const EVENT = {\n  ERROR: 'error',\n\n  TTFB: 'core.ttfb',\n  LOAD_START: 'core.loadstart',\n  LOAD_RESPONSE_HEADERS: 'core.loadresponseheaders',\n  LOAD_COMPLETE: 'core.loadcomplete',\n  LOAD_RETRY: 'core.loadretry',\n  SOURCEBUFFER_CREATED: 'core.sourcebuffercreated',\n  MEDIASOURCE_OPENED: 'core.mediasourceopened',\n  ANALYZE_DURATION_EXCEEDED: 'core.analyzedurationexceeded',\n  REMOVE_BUFFER: 'core.removebuffer',\n  BUFFEREOS: 'core.buffereos',\n  KEYFRAME: 'core.keyframe',\n  CHASEFRAME: 'core.chaseframe',\n  METADATA_PARSED: 'core.metadataparsed',\n  SEI: 'core.sei',\n  SEI_IN_TIME: 'core.seiintime',\n  FLV_SCRIPT_DATA: 'core.flvscriptdata',\n  LOWDECODE: 'core.lowdecode',\n  SWITCH_URL_SUCCESS: 'core.switchurlsuccess',\n  SWITCH_URL_FAILED: 'core.switchurlfailed',\n  SPEED: 'core.speed',\n  HLS_MANIFEST_LOADED: 'core.hlsmanifestloaded',\n  HLS_LEVEL_LOADED: 'core.hlslevelloaded',\n  DEMUXED_TRACK:'core.demuxedtrack',\n\n  STREAM_EXCEPTION: 'core.streamexception',\n  LARGE_AV_FIRST_FRAME_GAP_DETECT: 'LARGE_AV_FIRST_FRAME_GAP_DETECT',\n  LARGE_VIDEO_DTS_GAP_DETECT: 'LARGE_VIDEO_DTS_GAP_DETECT',\n  LARGE_AUDIO_DTS_GAP_DETECT: 'LARGE_AUDIO_DTS_GAP_DETECT',\n  AUDIO_GAP_DETECT: 'AUDIO_GAP_DETECT',\n  AUDIO_OVERLAP_DETECT: 'AUDIO_OVERLAP_DETECT',\n  MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT: 'MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT',\n  REAL_TIME_SPEED: 'real_time_speed'\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nconst CACHESIZE = 2 * 1024 * 1024\nexport class FetchLoader extends EventEmitter {\n  _abortController = null\n  _timeoutTimer = null\n  _reader = null\n  _response = null\n  _aborted = false\n  _index = -1\n  _range = null\n  _receivedLength = 0\n  _running = false\n  _logger = null\n  _vid = ''\n  _onProcessMinLen = 0\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n  constructor () {\n    super()\n  }\n\n  load ({\n    url,\n    vid,\n    timeout, // ms\n    responseType,\n    onProgress,\n    index,\n    onTimeout,\n    onCancel,\n    range,\n    transformResponse,\n    request,\n    params,\n    logger,\n\n    method,\n    headers,\n    body,\n    mode,\n    credentials,\n    cache,\n    redirect,\n    referrer,\n    referrerPolicy,\n    onProcessMinLen,\n    priOptions\n  }) {\n    this._logger = logger\n    this._aborted = false\n    this._onProcessMinLen = onProcessMinLen\n    this._onCancel = onCancel\n    this._abortController = typeof AbortController !== 'undefined' && new AbortController()\n    this._running = true\n    this._index = index\n    this._range = range || [0, 0]\n    this._vid = vid || url\n    this._priOptions = priOptions || {}\n    const init = {\n      method,\n      headers,\n      body,\n      mode,\n      credentials,\n      cache,\n      redirect,\n      referrer,\n      referrerPolicy,\n      signal: this._abortController?.signal\n    }\n\n    let isTimeout = false\n    clearTimeout(this._timeoutTimer)\n\n    url = setUrlParams(url, params)\n\n    const rangeValue = getRangeValue(range)\n    if (rangeValue) {\n      if (request) {\n        headers = request.headers\n      } else {\n        headers = init.headers = init.headers || (Headers ? new Headers() : {})\n      }\n      if (Headers && headers instanceof Headers) {\n        headers.append('Range', rangeValue)\n      } else {\n        headers.Range = rangeValue\n      }\n    }\n\n    if (timeout) {\n      this._timeoutTimer = setTimeout(() => {\n        isTimeout = true\n        this.cancel()\n        if (onTimeout) {\n          const error = new NetError(url, init, null, 'timeout')\n          error.isTimeout = true\n          onTimeout(error, {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n      }, timeout)\n    }\n\n    const startTime = Date.now()\n    this._logger.debug('[fetch load start], index,', index, ',range,', range)\n    return new Promise((resolve, reject) => {\n      fetch(request || url, request ? undefined : init).then(async (response) => {\n        clearTimeout(this._timeoutTimer)\n        this._response = response\n        if (this._aborted || !this._running) return\n        if (transformResponse) {\n          response = transformResponse(response, url) || response\n        }\n        if (!response.ok) {\n          throw new NetError(url, init, response, 'bad network response')\n        }\n\n        const firstByteTime = Date.now()\n        let data\n        if (responseType === ResponseType.TEXT) {\n          data = await response.text()\n          this._running = false\n        } else if (responseType === ResponseType.JSON) {\n          data = await response.json()\n          this._running = false\n        } else {\n          if (onProgress) {\n            this.resolve = resolve\n            this.reject = reject\n            this._loadChunk(response, onProgress, startTime, firstByteTime)\n            return\n          } else {\n            data = await response.arrayBuffer()\n            data = new Uint8Array(data)\n            this._running = false\n            const costTime = Date.now() - startTime\n            const speed = calculateSpeed(data.byteLength, costTime)\n            this.emit(EVENT.REAL_TIME_SPEED, {speed,len: data.byteLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n          }\n        }\n        this._logger.debug('[fetch load end], index,', index, ',range,', range)\n        resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          startTime,\n          firstByteTime,\n          index,\n          range,\n          this._vid,\n          this._priOptions\n        ))\n      }).catch((error) => {\n        clearTimeout(this._timeoutTimer)\n        this._running = false\n        if (this._aborted && !isTimeout) return\n        error = error instanceof NetError ? error : new NetError(url, init, null, error?.message)\n        error.startTime = startTime\n        error.endTime = Date.now()\n        error.isTimeout = isTimeout\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        reject(error)\n      })\n    })\n  }\n\n  async cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._running = false\n    if (this._response) {\n      try {\n        // await this._response.body.cancel()\n        if (this._reader) {\n          await this._reader.cancel()\n        }\n      } catch (error) {\n        // ignore\n      }\n      this._response = this._reader = null\n    }\n\n    if (this._abortController) {\n      try {\n        this._abortController.abort()\n      } catch (error) {\n        // ignore\n      }\n      this._abortController = null\n    }\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n  }\n\n  _loadChunk (response, onProgress, st, firstByteTime) {\n    if (!response.body || !response.body.getReader) {\n      this._running = false\n      const err = new NetError(response.url, '', response, 'onProgress of bad response.body.getReader')\n      err.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      this.reject(err)\n      return\n    }\n    if (this._onProcessMinLen > 0) {\n      this._cache = new Uint8Array(CACHESIZE)\n      this._writeIdx = 0\n    }\n    const reader = this._reader = response.body.getReader()\n    let data\n\n    let startTime\n    let endTime\n    const pump = async () => {\n      startTime = Date.now()\n      try {\n        data = await reader.read()\n        endTime = Date.now()\n      } catch (e) {\n        // request aborted\n        endTime = Date.now()\n        if (!this._aborted) {\n          this._running = false\n          e.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n          this.reject(e)\n        }\n        return\n      }\n      const startRange = this._range?.length > 0 ? this._range[0] : 0\n      const startByte = startRange + this._receivedLength\n      if (this._aborted) {\n        this._running = false\n        onProgress(undefined, false, { range: [startByte, startByte], vid: this._vid, index: this._index, startTime, endTime, st, firstByteTime, priOptions:this._priOptions }, response)\n        return\n      }\n      const curLen = data.value ? data.value.byteLength : 0\n      this._receivedLength += curLen\n      this._logger.debug('【fetchLoader,onProgress call】,task,', this._range, ', start,', startByte, ', end,', startRange + this._receivedLength, ', done,', data.done)\n      let retData\n      if (this._onProcessMinLen > 0) {\n        if (this._writeIdx + curLen >= this._onProcessMinLen || data.done) {\n          retData = new Uint8Array(this._writeIdx + curLen)\n          retData.set(this._cache.slice(0, this._writeIdx), 0)\n          curLen > 0 && retData.set(data.value, this._writeIdx)\n          this._writeIdx = 0\n          this._logger.debug('【fetchLoader,onProgress enough】,done,', data.done, ',len,', retData.byteLength, ', writeIdx,', this._writeIdx)\n        } else {\n          if (curLen > 0 && this._writeIdx + curLen < CACHESIZE) {\n            this._cache.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            this._logger.debug('【fetchLoader,onProgress cache】,len,', curLen, ', writeIdx,', this._writeIdx)\n          } else if (curLen > 0) {\n            const temp = new Uint8Array(this._writeIdx + curLen + 2048)\n            this._logger.debug('【fetchLoader,onProgress extra start】,size,', this._writeIdx + curLen + 2048, ', datalen,', curLen, ', writeIdx,', this._writeIdx)\n            temp.set(this._cache.slice(0, this._writeIdx), 0)\n            curLen > 0 && temp.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            delete this._cache\n            this._cache = temp\n            this._logger.debug('【fetchLoader,onProgress extra end】,len,', curLen, ', writeIdx,', this._writeIdx)\n          }\n        }\n      } else {\n        retData = data.value\n      }\n      if (retData && retData.byteLength > 0 || data.done) {\n        onProgress(retData, data.done, {\n          range: [this._range[0] + this._receivedLength - (retData ? retData.byteLength : 0), this._range[0] + this._receivedLength],\n          vid: this._vid,\n          index: this._index,\n          startTime,\n          endTime,\n          st,\n          firstByteTime,\n          priOptions:this._priOptions\n        }, response)\n      }\n      if (!data.done) {\n        pump()\n      } else {\n        const costTime = Date.now() - st\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed,len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n        this._running = false\n        this._logger.debug('[fetchLoader onProgress end],task,', this._range, ',done,', data.done)\n        this.resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          st,\n          firstByteTime,\n          this._index,\n          this._range,\n          this._vid,\n          this._priOptions\n        ))\n      }\n    }\n    pump()\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  static isSupported () {\n    return !!(typeof fetch !== 'undefined')\n  }\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nexport class XhrLoader extends EventEmitter {\n\n  _xhr = null\n  _aborted = false\n  _timeoutTimer = null\n  _range = null\n  _receivedLength = 0\n  _url = null\n  _onProgress = null\n  _index = -1\n  _headers = null\n  // _chunkSizeKBList = [\n  //   128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192\n  // ]\n\n  _currentChunkSizeKB = 384\n  _timeout = null\n  _xhr = null\n  _withCredentials = null\n  _startTime = -1\n  // _speedSampler = new SpeedSampler()\n  _loadCompleteResolve = null\n  _loadCompleteReject = null\n  _runing = false\n  _logger = false\n  _vid = ''\n  _responseType\n  _credentials\n  _method\n  _transformResponse\n  _firstRtt\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n\n  constructor () {\n    super()\n  }\n\n  load (req) {\n    clearTimeout(this._timeoutTimer)\n    this._logger = req.logger\n    this._range = req.range\n    this._onProgress = req.onProgress\n    this._index = req.index\n    this._headers = req.headers\n    this._withCredentials = req.credentials === 'include' || req.credentials === 'same-origin'\n    this._body = req.body || null\n    req.method && (this._method = req.method)\n    this._timeout = req.timeout || null\n    this._runing = true\n    this._vid = req.vid || req.url\n    this._responseType = req.responseType\n    this._firstRtt = -1\n    this._onTimeout = req.onTimeout\n    this._onCancel = req.onCancel\n    this._request = req.request\n    this._priOptions = req.priOptions || {}\n    this._logger.debug('【xhrLoader task】, range', this._range)\n\n    this._url = setUrlParams(req.url, req.params)\n\n    const startTime = Date.now()\n    return new Promise((resolve, reject) => {\n      this._loadCompleteResolve = resolve\n      this._loadCompleteReject = reject\n      this._startLoad()\n    }).catch((error) => {\n      clearTimeout(this._timeoutTimer)\n      this._runing = false\n      if (this._aborted) return\n      error = error instanceof NetError ? error : new NetError(this._url, this._request)\n      error.startTime = startTime\n      error.endTime = Date.now()\n      error.options = {index: this._index, vid: this._vid, priOptions: this._priOptions}\n      throw error\n    })\n  }\n\n  _startLoad () {\n    let range = null\n    if (this._responseType === ResponseType.ARRAY_BUFFER && this._range && this._range.length > 1) {\n      if (this._onProgress) {\n        this._firstRtt = -1\n        const chunkSize = this._currentChunkSizeKB * 1024\n        const from = this._range[0] + this._receivedLength\n        let to = this._range[1]\n        if (chunkSize < this._range[1] - from) {\n          to = from + chunkSize\n        }\n        range = [from, to]\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', SubRange, ', range)\n      } else {\n        range = this._range\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', allRange, ', range)\n      }\n    }\n    this._internalOpen(range)\n  }\n\n  _internalOpen (range) {\n    try {\n      this._startTime = Date.now()\n      const xhr = this._xhr = new XMLHttpRequest()\n      xhr.open(this._method || 'GET', this._url, true)\n      xhr.responseType = this._responseType\n      this._timeout && (xhr.timeout = this._timeout)\n      xhr.withCredentials = this._withCredentials\n      xhr.onload = this._onLoad.bind(this)\n      xhr.onreadystatechange = this._onReadyStatechange.bind(this)\n      xhr.onerror = (errorEvent) => {\n        this._running = false\n        const error = new NetError(this._url, this._request, errorEvent?.currentTarget?.response, ('xhr.onerror.status:' + errorEvent?.currentTarget?.status + ',statusText,' + errorEvent?.currentTarget?.statusText))\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      xhr.ontimeout = (event) => {\n        this.cancel()\n        const error = new NetError(this._url, this._request, {status:408}, 'timeout')\n        if (this._onTimeout) {\n          error.isTimeout = true\n          this._onTimeout(error,{index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      const headers = this._headers || {}\n      const rangeValue = getRangeValue(range)\n      if (rangeValue) {\n        headers.Range = rangeValue\n      }\n      if (headers) {\n        Object.keys(headers).forEach(k => {\n          xhr.setRequestHeader(k, headers[k])\n        })\n      }\n      this._logger.debug('[xhr.send->] tast,', this._range, ',load sub range, ', range)\n      xhr.send(this._body)\n    } catch (e) {\n      e.options = {index: this._index, range, vid: this._vid, priOptions: this._priOptions}\n      this._loadCompleteReject(e)\n    }\n  }\n\n  _onReadyStatechange (e) {\n    const xhr = e.target\n    if (xhr.readyState === 2) {\n      this._firstRtt < 0 && (this._firstRtt = Date.now())\n    }\n  }\n\n  _onLoad (e) {\n    const status = e.target.status\n    if (status < 200 || status > 299) {\n      const error = new NetError(this._url, null, { ...e.target.response, status }, 'bad response,status:' + status)\n      error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      return this._loadCompleteReject(error)\n    }\n    let data = null\n    let done = false\n    let byteStart\n    const startRange = (this._range?.length > 0 ? this._range [0] : 0 )\n    if (this._responseType === ResponseType.ARRAY_BUFFER) {\n      const chunk = new Uint8Array(e.target.response)\n      byteStart = startRange + this._receivedLength\n      if (chunk && chunk.byteLength > 0) {\n        this._receivedLength += chunk.byteLength\n        const costTime = Date.now() - this._startTime\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed, len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: [byteStart, startRange + this._receivedLength], priOptions: this._priOptions})\n      }\n      data = chunk\n      if (this._range?.length > 1 && this._range[1] && this._receivedLength < this._range[1] - this._range[0]) {\n        done = false\n      } else {\n        done = true\n      }\n      this._logger.debug('[xhr load done->], tast :', this._range, ', start', byteStart, 'end ', startRange + this._receivedLength, ',dataLen,', (chunk ? chunk.byteLength : 0), ',receivedLength', this._receivedLength, ',index,', this._index, ', done,', done)\n    } else {\n      done = true\n      data = e.target.response\n    }\n    let response = {\n      ok: status >= 200 && status < 300,\n      status,\n      statusText: this._xhr.statusText,\n      url: this._xhr.responseURL,\n      headers: this._getHeaders(this._xhr),\n      body: this._xhr.response\n    }\n    if (this._transformResponse) {\n      response = this._transformResponse(response, this._url) || response\n    }\n    if (this._onProgress) {\n      this._onProgress(data, done, { index: this._index, vid: this._vid, range: [byteStart, startRange + this._receivedLength], startTime: this._startTime, endTime: Date.now(), priOptions: this._priOptions }, response)\n    }\n\n    if (!done) {\n      this._startLoad()\n    } else {\n      this._runing = false\n      this._loadCompleteResolve && this._loadCompleteResolve(createResponse(\n        this._onProgress ? null : data,\n        done,\n        response,\n        response.headers['content-length'],\n        response.headers.age,\n        this._startTime,\n        this._firstRtt,\n        this._index,\n        this._range,\n        this._vid,\n        this._priOptions\n      ))\n    }\n  }\n\n  cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._runing = false\n    super.removeAllListeners()\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n    if (this._xhr) {\n      return this._xhr.abort()\n    }\n  }\n\n  static isSupported () {\n    return typeof XMLHttpRequest !== 'undefined'\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  _getHeaders (xhr) {\n    const headerLines = xhr.getAllResponseHeaders().trim().split('\\r\\n')\n    const headers = {}\n    for (const header of headerLines) {\n      const parts = header.split(': ')\n      headers[parts[0].toLowerCase()] = parts.slice(1).join(': ')\n    }\n    return headers\n  }\n}\n","import { FetchLoader } from './fetch'\nimport { XhrLoader } from './xhr'\nimport { LoaderType } from './types'\nimport { createPublicPromise } from '../utils'\nimport { Logger } from '../logger'\n\nexport class Task {\n  constructor (type, config) {\n    this.promise = createPublicPromise()\n    this.alive = !!config.onProgress\n    !config.logger && (config.logger = new Logger('Loader'))\n    this._loaderType = type\n    this._loader = type === LoaderType.FETCH && typeof fetch !== 'undefined' ? new FetchLoader() : new XhrLoader()\n    this._config = config\n    this._retryCount = 0\n    this._retryTimer = null\n    this._canceled = false\n    this._retryCheckFunc = config.retryCheckFunc\n    this._logger = config.logger\n  }\n\n  exec () {\n    const {\n      retry,\n      retryDelay,\n      onRetryError,\n      transformError,\n      ...rest\n    } = this._config\n\n    const request = async () => {\n      try {\n        const response = await this._loader.load(rest)\n        this.promise.resolve(response)\n      } catch (e) {\n        this._loader.running = false\n        this._logger.debug('[task request catch err]', e)\n        if (this._canceled) return\n\n        e.loaderType = this._loaderType\n        e.retryCount = this._retryCount\n\n        let error = e\n        if (transformError) {\n          error = transformError(error) || error\n        }\n\n        if (onRetryError && this._retryCount > 0) onRetryError(error, this._retryCount, {index: rest.index, vid: rest.vid, range: rest.range, priOptions: rest.priOptions})\n\n        this._retryCount++\n        let isRetry = true\n        if (this._retryCheckFunc) {\n          isRetry = this._retryCheckFunc(e)\n        }\n        if (isRetry && this._retryCount <= retry) {\n          clearTimeout(this._retryTimer)\n          this._logger.debug('[task request setTimeout],retry', this._retryCount, ',retry range,', rest.range)\n          this._retryTimer = setTimeout(request, retryDelay)\n          return\n        }\n        this.promise.reject(error)\n      }\n    }\n\n    request()\n    return this.promise\n  }\n\n  async cancel () {\n    clearTimeout(this._retryTimer)\n    this._canceled = true\n    this._loader.running = false\n    return this._loader.cancel()\n  }\n\n  get running () {\n    return this._loader && this._loader.running\n  }\n\n  get loader () {\n    return this._loader\n  }\n}\n","export function isMediaPlaying (media) {\n  return media && !media.paused && !media.ended && media.playbackRate !== 0 && media.readyState !== 0\n}\n\nexport function getVideoPlaybackQuality (video) {\n  if (!video) return {}\n  if (typeof video.getVideoPlaybackQuality === 'function') {\n    const info = video.getVideoPlaybackQuality()\n    return {\n      droppedVideoFrames: info.droppedVideoFrames || info.corruptedVideoFrames,\n      totalVideoFrames: info.totalVideoFrames,\n      creationTime: info.creationTime\n    }\n  }\n\n  return {\n    droppedVideoFrames: video.webkitDroppedFrameCount,\n    totalVideoFrames: video.webkitDecodedFrameCount,\n    creationTime: performance.now()\n  }\n}\n\n/**\n * @param {Array.<Uint8Array>} arr\n * @returns\n */\nexport function concatUint8Array (...arr) {\n  arr = arr.filter(Boolean)\n  if (arr.length < 2) return arr[0]\n  const data = new Uint8Array(arr.reduce((p, c) => p + c.byteLength, 0))\n  let prevLen = 0\n  arr.forEach((d) => {\n    data.set(d, prevLen)\n    prevLen += d.byteLength\n  })\n  return data\n}\n\nexport function sleep (t = 0) {\n  return new Promise((resolve) => setTimeout(resolve, t))\n}\n","import { FetchLoader } from './fetch'\nimport { LoaderType, ResponseType } from './types'\nimport { getConfig } from './config'\nimport { Task } from './task'\nimport { isPlainObject } from '../is'\nimport { sleep } from '../streaming-helper'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\n\nexport {\n  LoaderType,\n  ResponseType\n}\n\nexport class NetLoader extends EventEmitter {\n  type = LoaderType.FETCH\n\n  _queue = []\n\n  _alive = []\n\n  _currentTask = null\n\n  _finnalUrl = ''\n\n  _config\n\n  constructor (cfg) {\n    super(cfg)\n    this._config = getConfig(cfg)\n    if (\n      this._config.loaderType === LoaderType.XHR ||\n      !FetchLoader.isSupported()\n    ) {\n      this.type = LoaderType.XHR\n    }\n    this.log = cfg.logger\n  }\n\n  isFetch () {\n    return this.type === LoaderType.FETCH\n  }\n\n  static isFetchSupport () {\n    return FetchLoader.isSupported()\n  }\n\n  load (url, config = {}) {\n    if (typeof url === 'string' || !url) {\n      config.url = url || config.url || this._config.url\n    } else {\n      config = url\n    }\n\n    config = Object.assign({}, this._config, config)\n\n    if (config.params) config.params = Object.assign({}, config.params)\n    if (config.headers && isPlainObject(config.headers)) config.headers = Object.assign({}, config.headers)\n    if (config.body && isPlainObject(config.body)) config.body = Object.assign({}, config.body)\n\n    if (config.transformRequest) {\n      config = config.transformRequest(config) || config\n    }\n    config.logger = this.log\n\n    const task = new Task(this.type, config)\n    task.loader.on(EVENT.REAL_TIME_SPEED, (data) => {\n      this.emit(EVENT.REAL_TIME_SPEED, data)\n    })\n    this._queue.push(task)\n    if (this._queue.length === 1 && (!this._currentTask || !this._currentTask.running)) {\n      this._processTask()\n    }\n\n    return task.promise\n  }\n\n  async cancel () {\n    const cancels = this._queue.map(t => t.cancel()).concat(this._alive.map(t => t.cancel()))\n    if (this._currentTask) {\n      cancels.push(this._currentTask.cancel())\n    }\n    this._queue = []\n    this._alive = []\n    await Promise.all(cancels)\n    await sleep()\n  }\n\n  _processTask () {\n    this._currentTask = this._queue.shift()\n    if (!this._currentTask) return\n\n    if (this._currentTask.alive) {\n      this._alive.push(this._currentTask)\n    }\n    const req = this._currentTask.exec().catch(e => {})\n\n    if (!(req && typeof req.finally === 'function')) return\n\n    req.finally(() => {\n      if (this._currentTask?.alive && this._alive?.length > 0) {\n        this._alive = this._alive.filter(task => task && task !== this._currentTask)\n      }\n      this._processTask()\n    })\n\n  }\n}\n","import { LoaderType, ResponseType } from './types'\n\nexport function getConfig (cfg) {\n  return {\n    loaderType: LoaderType.FETCH,\n    retry: 0,\n    retryDelay: 0, // ms\n    timeout: 0,\n    request: null, // Request\n    onTimeout: undefined,\n    onProgress: undefined,\n    onRetryError: undefined,\n    transformRequest: undefined,\n    transformResponse: undefined,\n    transformError: undefined,\n    responseType: ResponseType.TEXT,\n    range: undefined,\n    url: '',\n    params: undefined,\n    method: 'GET',\n    headers: {},\n    body: undefined,\n    mode: undefined,\n    credentials: undefined,\n    cache: undefined,\n    redirect: undefined,\n    referrer: undefined,\n    referrerPolicy: undefined,\n    integrity: undefined,\n    onProcessMinLen: 0,\n    ...cfg\n  }\n}\n","import { Buffer } from '../buffer'\n\nexport class GapService {\n  _prevCurrentTime = 0\n\n  do (media, maxJumpDistance = 3, isLive, seekThreshold = 1) {\n    if (!media) return\n\n    const currentTime = media.currentTime\n    let jumpTo = 0\n\n    if (this._prevCurrentTime === currentTime) {\n      const info = Buffer.info(Buffer.get(media), currentTime)\n      if (!info.buffers.length) return\n      if (\n        (isLive && info.nextStart) ||\n        (info.nextStart && info.nextStart - currentTime < maxJumpDistance)\n      ) {\n        jumpTo = info.nextStart + 0.1\n      } else if (info.end && info.end - currentTime > seekThreshold && !media.seeking) {\n        jumpTo = currentTime + 0.1\n      }\n    }\n\n    this._prevCurrentTime = currentTime\n\n    if (jumpTo && currentTime !== jumpTo) {\n      media.currentTime = jumpTo\n    }\n  }\n}\n","import { EVENT } from '../event'\n\nexport class SeiService {\n  _seiSet = new Set()\n\n  constructor (emitter) {\n    this.emitter = emitter\n\n    emitter.on(EVENT.SEI, sei => {\n      if (sei) this._seiSet.add(sei)\n    })\n  }\n\n  throw (currentTime, isLive) {\n    if (currentTime === null || currentTime === undefined || !this._seiSet.size) return\n    const min = currentTime - 0.2\n    const max = currentTime + 0.2\n    const toThrow = []\n    this._seiSet.forEach(sei => {\n      if (sei.time >= min && sei.time <= max) {\n        toThrow.push(sei)\n      }\n    })\n\n    toThrow.forEach(sei => {\n      this._seiSet.delete(sei)\n      this.emitter.emit(EVENT.SEI_IN_TIME, sei)\n    })\n\n    if (!isLive) return\n\n    this._seiSet.forEach(s => {\n      if (s.time < currentTime - 5) {\n        this._seiSet.delete(s)\n      }\n    })\n  }\n\n  reset () {\n    this._seiSet.clear()\n  }\n}\n","export class BandwidthService {\n  _chunkSpeeds = [] // bps\n  _speeds = [] // bps\n\n  addRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._speeds.push(8000 * totalByte / ms)\n    this._speeds = this._speeds.slice(-3)\n  }\n\n  addChunkRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._chunkSpeeds.push(8000 * totalByte / ms)\n    this._chunkSpeeds = this._chunkSpeeds.slice(-100)\n  }\n\n  getAvgSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds.reduce((a, c) => (a += c)) / this._speeds.length\n    }\n    return this._chunkSpeeds.reduce((a, c) => (a += c)) / this._chunkSpeeds.length\n  }\n\n  getLatestSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds[this._speeds.length - 1]\n    }\n    return this._chunkSpeeds[this._chunkSpeeds.length - 1]\n  }\n\n  reset () {\n    this._chunkSpeeds = []\n    this._speeds = []\n  }\n}\n","import { EVENT } from 'xgplayer-streaming-shared'\n\nclass Stats {\n  encodeType = '' // hevc | avc\n  audioCodec = ''\n  videoCodec = ''\n  domain = '' // stream url domain\n  fps = 0\n  bitrate = 0 // 最新1s下载数据的码率\n  width = 0\n  height = 0\n  samplerate = 0\n  channelCount = 0\n  gop = 0 // 第一个gop帧数\n\n  _bitsAccumulateSize = 0\n  _bitsAccumulateDuration = 0\n  _startGopId = -1\n\n  constructor (timescale) {\n    this._timescale = timescale\n  }\n\n  getStats () {\n    return {\n      encodeType: this.encodeType,\n      audioCodec: this.audioCodec,\n      videoCodec: this.videoCodec,\n      domain: this.domain,\n      fps: this.fps,\n      bitrate: this.bitrate,\n      width: this.width,\n      height: this.height,\n      samplerate: this.samplerate,\n      channelCount: this.channelCount,\n      gop: this.gop\n    }\n  }\n\n  setEncodeType (encode) {\n    this.encodeType = encode\n  }\n\n  setFpsFromScriptData ({data}) {\n    const fps = data?.onMetaData?.framerate\n    if (fps && fps > 0 && fps < 100) {\n      this.fps = fps\n    }\n  }\n\n  setVideoMeta (track) {\n    this.width = track.width\n    this.height = track.height\n    this.videoCodec = track.codec\n    this.encodeType = track.codecType\n    if (track.fpsNum && track.fpsDen) {\n      const fps = track.fpsNum / track.fpsDen\n      if (fps > 0 && fps < 100) {\n        this.fps = fps\n      }\n    }\n  }\n\n  setAudioMeta (track) {\n    this.audioCodec = track.codec\n    this.samplerate = track.sampleRate\n    this.channelCount = track.channelCount\n  }\n\n  setDomain (responseUrl) {\n    this.domain = responseUrl.split('/').slice(2, 3)[0]\n  }\n\n  updateBitrate (samples) {\n    if (!this.fps || this.fps >= 100) {\n      if (samples.length) {\n        const duration = samples.reduce((a,b) => a += b.duration, 0) / samples.length\n        this.fps = Math.round(this._timescale / duration)\n      }\n    }\n    samples.forEach(sample => {\n      if (this._startGopId === -1) {\n        this._startGopId = sample.gopId\n      }\n      if (sample.gopId === this._startGopId) {\n        this.gop++\n      }\n      this._bitsAccumulateDuration += sample.duration / (this._timescale / 1000)\n      this._bitsAccumulateSize += sample.units.reduce((a, c) => (a += c.length), 0)\n      if (this._bitsAccumulateDuration >= 1000) {\n        this.bitrate = this._bitsAccumulateSize * 8\n        this._bitsAccumulateDuration = 0\n        this._bitsAccumulateSize = 0\n      }\n    })\n  }\n}\n\n\n/**\n * @typedef {Object} StatsInfo\n * @property {number} downloadSpeed\n * @property {number} avgSpeed\n * @property {number} currentTime\n * @property {number} bufferEnd\n * @property {number} decodeFps\n * @property {string} encodeType\n * @property {string} audioCodec\n * @property {string} videoCodec\n * @property {string} domain\n * @property {number} fps\n * @property {number} bitrate\n * @property {number} width\n * @property {number} height\n * @property {number} samplerate\n * @property {number} channelCount\n * @property {number} gop\n */\nclass MediaStatsService {\n\n  _core = null\n\n  _samples = []\n\n  constructor (core, timescale = 1000) {\n    this._core = core\n    this._timescale = timescale\n    this._stats = new Stats(timescale)\n    this._bindEvents()\n  }\n\n\n  /** @returns {StatsInfo} */\n  getStats () {\n    const { currentTime = 0, decodeFps = 0 } = this._core?.media || {}\n    return {\n      ...this._stats.getStats(),\n      downloadSpeed: this._core?.speedInfo?.().speed || 0,\n      avgSpeed: this._core?.speedInfo?.().avgSpeed || 0,\n      currentTime,\n      bufferEnd: this._core?.bufferInfo()?.remaining || 0,\n      decodeFps\n    }\n  }\n\n  _bindEvents () {\n    this._core.on(EVENT.DEMUXED_TRACK, ({videoTrack}) => this._stats.updateBitrate(videoTrack.samples))\n\n    this._core.on(EVENT.FLV_SCRIPT_DATA, data => {\n      this._stats.setFpsFromScriptData(data)\n    })\n\n    this._core.on(EVENT.METADATA_PARSED, e => {\n      if (e.type === 'video') {\n        this._stats.setVideoMeta(e.track)\n      } else {\n        this._stats.setAudioMeta(e.track)\n      }\n    })\n\n    this._core.on(EVENT.TTFB, e => {\n      this._stats.setDomain(e.responseUrl)\n    })\n\n  }\n\n  reset () {\n    this._samples = []\n    this._stats = new Stats(this._timescale)\n  }\n\n}\n\nexport { MediaStatsService }\n","import * as mse from './mse'\nimport * as buffer from './buffer'\nimport * as net from './net'\nimport * as error from './error'\nimport * as event from './event'\nimport * as services from './services'\nimport * as streamingHelper from './streaming-helper'\nimport { Logger } from './logger'\n\nexport default {\n  ...mse,\n  ...buffer,\n  ...net,\n  ...error,\n  ...event,\n  ...services,\n  ...streamingHelper,\n  Logger\n}\n"],"names":["Buffer","_classCallCheck","key","value","buf","length","end","start","b","buffered","error","maxHole","buffers","i","l","bufLen","last","lastEnd","push","reduce","a","c","pos","arguments","undefined","index","nextStart","nextEnd","prevStart","prevEnd","item","currentTime","behind","remaining","totalLength","isBrowser","window","ERR","MANIFEST","NETWORK","NETWORK_TIMEOUT","NETWORK_FORBIDDEN","NETWORK_NOTFOUND","NETWROK_RANGE_NOT_SATISFIABLE","DEMUX","REMUX","MEDIA","DRM","OTHER","RUNTIME","SUB_TYPES","FLV","HLS","MP4","FMP4","MSE_ADD_SB","MSE_APPEND_BUFFER","MSE_OTHER","MSE_FULL","OPTION","DASH","LICENSE","CUSTOM_LICENSE","MSE_HIJACK","EME_HIJACK","SIDX","NO_CANPLAY_ERROR","BUFFERBREAK_ERROR","WAITING_TIMEOUT_ERROR","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_CODEC_NOT_SUPPORTED","MEDIA_ERR_URL_EMPTY","ERR_CODE","_defineProperty","_ERR_CODE","StreamingError","_Error","_inherits","_super","_createSuper","type","subType","origin","payload","msg","_this","call","message","errorType","originError","ext","errorCode","errorMessage","Error","_error$response","isTimeout","url","response","httpCode","status","LogCacheLevel","DEBUG","LOG","WARN","ERROR","SIMPLE_TYPE","Logger","name","config","this","_prefix","concat","logCacheLevel","logMaxSize","logSize","logTextArray","_createClass","_console","_len","args","Array","_key","logCache","apply","disabled","console","debug","nowTime","_console2","_len2","_key2","log","_console3","_len3","_key3","warn","_console4","_len4","_key4","text","_len5","logText","_key5","finLogText","map","logable","JSON","stringify","e","delLog","shift","join","reset","_console5","group","table","groupEnd","val","Date","toLocaleString","reduceDepth","_typeof","objType","Object","prototype","toString","slice","obj","maxDepth","depth","result","includes","hasOwnProperty","createPublicPromise","res","rej","promise","Promise","resolve","reject","used","parseInt","performance","now","getTime","SafeJSON","getMediaSource","preferMMS","ManagedMediaSource","MediaSource","isMMS","mediaSource","test","OP_NAME","MSEError","MSE","media","_this2","create","_logger","queue","_queue","op","opName","_this2$_sourceBuffer$","costtime","_opst","ranges","TimeRanges","getTimeRanges","_sourceBuffer","context","_startQueue","event","_config","assign","getDefaultConfig","bindMedia","openLog","enable","_enqueueBlockingOp2","_unbindMedia","_bindMedia","get","_this$mediaSource","readyState","_this3","flag","keys","forEach","k","isArray","_url","_this$mediaSource2","duration","streaming","_mseFullFlag","VIDEO","_this4","isReduceDuration","bufferEnd","Math","max","_enqueueBlockingOp","isEnded","_this5","_openPromise","isOpened","ms","addEventListener","onOpen","costTime","_st","removeEventListener","_asyncToGenerator","_regeneratorRuntime","mark","_callee","useMMS","_this6","wrap","_context","prev","next","unbindMedia","revokeObjectURL","src","_onStartStreaming","_onEndStreaming","URL","createObjectURL","disableRemotePlayback","abrupt","stop","_x","_callee2","hasMetadata","mseOpen","_this7","_context2","t","x","_x$promise","_x$promise$resolve","endOfStream","removeSourceBuffer","removeAttribute","load","mimeType","sb","addSourceBuffer","_onSBUpdateEnd","bind","_onSBUpdateError","_this8","changeType","_enqueueOp","createSource","buffer","_this9","byteLength","_this9$_sourceBuffer$","appendBuffer","startTime","endTime","_this10","isInsertHead","remove","p","_this11","_this12","allClear","_this$_queue$type","initQueue","isinit","reason","_this13","setLiveSeekableRange","exec","_this14","splice","then","_callee3","types","waiters","_this15","_context3","prom","all","updating","_x2","_x3","_x4","indexOf","timestampOffset","_this16","_this17","abort","mime","isTypeSupported","UPDATE_ERROR","LoaderType","FETCH","XHR","ResponseType","ARRAY_BUFFER","TEXT","NetError","request","_assertThisInitialized","isPlainObject","getPrototypeOf","getRangeValue","ret","encode","encodeURIComponent","replace","setUrlParams","params","v","str","toISOString","isObject","filter","Boolean","hashIndex","createResponse","data","done","contentLength","age","firstByteTime","range","vid","priOptions","parseFloat","Number","isNaN","options","calculateSpeed","byteLen","millisec","round","EVENT","TTFB","LOAD_START","LOAD_RESPONSE_HEADERS","LOAD_COMPLETE","LOAD_RETRY","SOURCEBUFFER_CREATED","MEDIASOURCE_OPENED","ANALYZE_DURATION_EXCEEDED","REMOVE_BUFFER","BUFFEREOS","KEYFRAME","CHASEFRAME","METADATA_PARSED","SEI","SEI_IN_TIME","FLV_SCRIPT_DATA","LOWDECODE","SWITCH_URL_SUCCESS","SWITCH_URL_FAILED","SPEED","HLS_MANIFEST_LOADED","HLS_LEVEL_LOADED","DEMUXED_TRACK","STREAM_EXCEPTION","LARGE_AV_FIRST_FRAME_GAP_DETECT","LARGE_VIDEO_DTS_GAP_DETECT","LARGE_AUDIO_DTS_GAP_DETECT","AUDIO_GAP_DETECT","AUDIO_OVERLAP_DETECT","MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT","REAL_TIME_SPEED","has","prefix","Events","EE","fn","once","addListener","emitter","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","names","events","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","len","removeListener","j","on","removeAllListeners","off","prefixed","module","exports","CACHESIZE","FetchLoader","_EventEmitter","_cancel","_ref","_this$_abortControlle","timeout","responseType","onProgress","onTimeout","onCancel","transformResponse","logger","method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","onProcessMinLen","_aborted","_onProcessMinLen","_onCancel","_abortController","AbortController","_running","_index","_range","_vid","_priOptions","init","signal","clearTimeout","_timeoutTimer","rangeValue","Headers","append","Range","setTimeout","cancel","fetch","_ref2","speed","_response","ok","sent","json","_loadChunk","arrayBuffer","Uint8Array","time","catch","_error","_reader","t0","st","getReader","err","_cache","_writeIdx","reader","pump","_ref3","_this3$_range","startRange","startByte","curLen","retData","temp","read","_receivedLength","set","XhrLoader","req","_onProgress","_headers","_withCredentials","_body","_method","_timeout","_runing","_responseType","_firstRtt","_onTimeout","_request","_loadCompleteResolve","_loadCompleteReject","_startLoad","chunkSize","_currentChunkSizeKB","from","to","_internalOpen","_startTime","xhr","_xhr","XMLHttpRequest","open","withCredentials","onload","_onLoad","onreadystatechange","_onReadyStatechange","onerror","errorEvent","_errorEvent$currentTa","_errorEvent$currentTa2","_errorEvent$currentTa3","currentTarget","statusText","ontimeout","setRequestHeader","send","target","_this$_range","_objectSpread","byteStart","_this$_range2","chunk","responseURL","_getHeaders","_transformResponse","_getPrototypeOf","_step","_iterator","_createForOfIteratorHelper","getAllResponseHeaders","trim","split","s","n","parts","toLowerCase","f","Task","alive","_loaderType","_loader","_retryCount","_retryTimer","_canceled","_retryCheckFunc","retryCheckFunc","_this$_config","retry","retryDelay","onRetryError","transformError","rest","_objectWithoutProperties","_excluded","isRetry","running","loaderType","retryCount","sleep","paused","ended","playbackRate","video","getVideoPlaybackQuality","info","droppedVideoFrames","corruptedVideoFrames","totalVideoFrames","creationTime","webkitDroppedFrameCount","webkitDecodedFrameCount","arr","prevLen","d","NetLoader","cfg","transformRequest","integrity","getConfig","isSupported","task","loader","_currentTask","_processTask","cancels","_alive","finally","_this3$_currentTask","_this3$_alive","GapService","maxJumpDistance","isLive","seekThreshold","jumpTo","_prevCurrentTime","seeking","SeiService","Set","sei","_seiSet","add","size","min","toThrow","delete","clear","BandwidthService","totalByte","_speeds","_chunkSpeeds","Stats","timescale","_timescale","encodeType","audioCodec","videoCodec","domain","fps","bitrate","width","height","samplerate","channelCount","gop","_data$onMetaData","onMetaData","framerate","track","codec","codecType","fpsNum","fpsDen","sampleRate","responseUrl","samples","sample","_startGopId","gopId","_bitsAccumulateDuration","_bitsAccumulateSize","units","MediaStatsService","core","_core","_stats","_bindEvents","_this$_core","_this$_core2","_this$_core2$speedInf","_this$_core3","_this$_core3$speedInf","_this$_core4","_this$_core4$bufferIn","_ref2$currentTime","_ref2$decodeFps","decodeFps","getStats","downloadSpeed","speedInfo","avgSpeed","bufferInfo","videoTrack","updateBitrate","setFpsFromScriptData","setVideoMeta","setAudioMeta","setDomain","_samples","mse","net","services","streamingHelper"],"mappings":"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"}