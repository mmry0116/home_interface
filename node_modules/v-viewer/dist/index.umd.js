/*!
 * v-viewer v3.0.11
 * https://github.com/mirari/v-viewer#readme
 *
 * Copyright 2022 mirari
 * Released under the MIT license
 *
 * Date: 2022-10-25T08:49:33.301Z
 */(function(b,O){typeof exports=="object"&&typeof module!="undefined"?O(exports,require("viewerjs"),require("vue")):typeof define=="function"&&define.amd?define(["exports","viewerjs","vue"],O):(b=typeof globalThis!="undefined"?globalThis:b||self,O(b.VueViewer={},b.Viewer,b.Vue))})(this,function(b,O,v){"use strict";function be(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var m=be(O),A=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function pe(e){return e}var U=pe;function ge(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}var $e=ge,me=$e,B=Math.max;function we(e,r,t){return r=B(r===void 0?e.length-1:r,0),function(){for(var n=arguments,i=-1,c=B(n.length-r,0),u=Array(c);++i<c;)u[i]=n[r+i];i=-1;for(var s=Array(r+1);++i<r;)s[i]=n[i];return s[r]=t(u),me(e,this,s)}}var Te=we;function _e(e){return function(){return e}}var he=_e,je=typeof A=="object"&&A&&A.Object===Object&&A,D=je,Oe=D,Ie=typeof self=="object"&&self&&self.Object===Object&&self,Se=Oe||Ie||Function("return this")(),P=Se,Ae=P,Pe=Ae.Symbol,G=Pe,W=G,K=Object.prototype,xe=K.hasOwnProperty,Ee=K.toString,I=W?W.toStringTag:void 0;function ke(e){var r=xe.call(e,I),t=e[I];try{e[I]=void 0;var n=!0}catch{}var i=Ee.call(e);return n&&(r?e[I]=t:delete e[I]),i}var Me=ke,Ve=Object.prototype,Le=Ve.toString;function Ce(e){return Le.call(e)}var Fe=Ce,q=G,Ne=Me,Re=Fe,Ue="[object Null]",Be="[object Undefined]",H=q?q.toStringTag:void 0;function De(e){return e==null?e===void 0?Be:Ue:H&&H in Object(e)?Ne(e):Re(e)}var x=De;function Ge(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var w=Ge,We=x,Ke=w,qe="[object AsyncFunction]",He="[object Function]",Je="[object GeneratorFunction]",Xe="[object Proxy]";function ze(e){if(!Ke(e))return!1;var r=We(e);return r==He||r==Je||r==qe||r==Xe}var J=ze,Qe=P,Ye=Qe["__core-js_shared__"],Ze=Ye,V=Ze,X=function(){var e=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function er(e){return!!X&&X in e}var rr=er,tr=Function.prototype,nr=tr.toString;function ir(e){if(e!=null){try{return nr.call(e)}catch{}try{return e+""}catch{}}return""}var ar=ir,or=J,sr=rr,cr=w,ur=ar,fr=/[\\^$.*+?()[\]{}|]/g,dr=/^\[object .+?Constructor\]$/,lr=Function.prototype,vr=Object.prototype,yr=lr.toString,br=vr.hasOwnProperty,pr=RegExp("^"+yr.call(br).replace(fr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gr(e){if(!cr(e)||sr(e))return!1;var r=or(e)?pr:dr;return r.test(ur(e))}var $r=gr;function mr(e,r){return e==null?void 0:e[r]}var wr=mr,Tr=$r,_r=wr;function hr(e,r){var t=_r(e,r);return Tr(t)?t:void 0}var jr=hr,Or=jr,Ir=function(){try{var e=Or(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Sr=Ir,Ar=he,z=Sr,Pr=U,xr=z?function(e,r){return z(e,"toString",{configurable:!0,enumerable:!1,value:Ar(r),writable:!0})}:Pr,Er=xr,kr=800,Mr=16,Vr=Date.now;function Lr(e){var r=0,t=0;return function(){var n=Vr(),i=Mr-(n-t);if(t=n,i>0){if(++r>=kr)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var Cr=Lr,Fr=Er,Nr=Cr,Rr=Nr(Fr),Ur=Rr,Br=U,Dr=Te,Gr=Ur;function Wr(e,r){return Gr(Dr(e,r,Br),e+"")}var Kr=Wr;function qr(e,r){return e===r||e!==e&&r!==r}var Q=qr,Hr=9007199254740991;function Jr(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Hr}var Y=Jr,Xr=J,zr=Y;function Qr(e){return e!=null&&zr(e.length)&&!Xr(e)}var Z=Qr,Yr=9007199254740991,Zr=/^(?:0|[1-9]\d*)$/;function et(e,r){var t=typeof e;return r=r==null?Yr:r,!!r&&(t=="number"||t!="symbol"&&Zr.test(e))&&e>-1&&e%1==0&&e<r}var ee=et,rt=Q,tt=Z,nt=ee,it=w;function at(e,r,t){if(!it(t))return!1;var n=typeof r;return(n=="number"?tt(t)&&nt(r,t.length):n=="string"&&r in t)?rt(t[r],e):!1}var ot=at;function st(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}var ct=st;function ut(e){return e!=null&&typeof e=="object"}var E=ut,ft=x,dt=E,lt="[object Arguments]";function vt(e){return dt(e)&&ft(e)==lt}var yt=vt,re=yt,bt=E,te=Object.prototype,pt=te.hasOwnProperty,gt=te.propertyIsEnumerable,$t=re(function(){return arguments}())?re:function(e){return bt(e)&&pt.call(e,"callee")&&!gt.call(e,"callee")},mt=$t,wt=Array.isArray,Tt=wt,L={exports:{}};function _t(){return!1}var ht=_t;(function(e,r){var t=P,n=ht,i=r&&!r.nodeType&&r,c=i&&!0&&e&&!e.nodeType&&e,u=c&&c.exports===i,s=u?t.Buffer:void 0,d=s?s.isBuffer:void 0,o=d||n;e.exports=o})(L,L.exports);var jt=x,Ot=Y,It=E,St="[object Arguments]",At="[object Array]",Pt="[object Boolean]",xt="[object Date]",Et="[object Error]",kt="[object Function]",Mt="[object Map]",Vt="[object Number]",Lt="[object Object]",Ct="[object RegExp]",Ft="[object Set]",Nt="[object String]",Rt="[object WeakMap]",Ut="[object ArrayBuffer]",Bt="[object DataView]",Dt="[object Float32Array]",Gt="[object Float64Array]",Wt="[object Int8Array]",Kt="[object Int16Array]",qt="[object Int32Array]",Ht="[object Uint8Array]",Jt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",zt="[object Uint32Array]",f={};f[Dt]=f[Gt]=f[Wt]=f[Kt]=f[qt]=f[Ht]=f[Jt]=f[Xt]=f[zt]=!0,f[St]=f[At]=f[Ut]=f[Pt]=f[Bt]=f[xt]=f[Et]=f[kt]=f[Mt]=f[Vt]=f[Lt]=f[Ct]=f[Ft]=f[Nt]=f[Rt]=!1;function Qt(e){return It(e)&&Ot(e.length)&&!!f[jt(e)]}var Yt=Qt;function Zt(e){return function(r){return e(r)}}var en=Zt,C={exports:{}};(function(e,r){var t=D,n=r&&!r.nodeType&&r,i=n&&!0&&e&&!e.nodeType&&e,c=i&&i.exports===n,u=c&&t.process,s=function(){try{var d=i&&i.require&&i.require("util").types;return d||u&&u.binding&&u.binding("util")}catch{}}();e.exports=s})(C,C.exports);var rn=Yt,tn=en,ne=C.exports,ie=ne&&ne.isTypedArray,nn=ie?tn(ie):rn,an=nn,on=ct,sn=mt,cn=Tt,un=L.exports,fn=ee,dn=an,ln=Object.prototype,vn=ln.hasOwnProperty;function yn(e,r){var t=cn(e),n=!t&&sn(e),i=!t&&!n&&un(e),c=!t&&!n&&!i&&dn(e),u=t||n||i||c,s=u?on(e.length,String):[],d=s.length;for(var o in e)(r||vn.call(e,o))&&!(u&&(o=="length"||i&&(o=="offset"||o=="parent")||c&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||fn(o,d)))&&s.push(o);return s}var bn=yn,pn=Object.prototype;function gn(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||pn;return e===t}var $n=gn;function mn(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var wn=mn,Tn=w,_n=$n,hn=wn,jn=Object.prototype,On=jn.hasOwnProperty;function In(e){if(!Tn(e))return hn(e);var r=_n(e),t=[];for(var n in e)n=="constructor"&&(r||!On.call(e,n))||t.push(n);return t}var Sn=In,An=bn,Pn=Sn,xn=Z;function En(e){return xn(e)?An(e,!0):Pn(e)}var kn=En,Mn=Kr,Vn=Q,Ln=ot,Cn=kn,ae=Object.prototype,Fn=ae.hasOwnProperty,Nn=Mn(function(e,r){e=Object(e);var t=-1,n=r.length,i=n>2?r[2]:void 0;for(i&&Ln(r[0],r[1],i)&&(n=1);++t<n;)for(var c=r[t],u=Cn(c),s=-1,d=u.length;++s<d;){var o=u[s],T=e[o];(T===void 0||Vn(T,ae[o])&&!Fn.call(e,o))&&(e[o]=c[o])}return e}),Rn=Nn;const Un=typeof window!="undefined"&&window!==null;Wn();const Bn=Object.prototype.propertyIsEnumerable,oe=Object.getOwnPropertySymbols;function k(e){return typeof e=="function"||toString.call(e)==="[object Object]"}function Dn(e){return typeof e=="object"?e===null:typeof e!="function"}function Gn(e){return e!=="__proto__"&&e!=="constructor"&&e!=="prototype"}function Wn(){return Un&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function Kn(e,...r){if(!k(e))throw new TypeError("expected the first argument to be an object");if(r.length===0||typeof Symbol!="function"||typeof oe!="function")return e;for(const t of r){const n=oe(t);for(const i of n)Bn.call(t,i)&&(e[i]=t[i])}return e}function se(e,...r){let t=0;for(Dn(e)&&(e=r[t++]),e||(e={});t<r.length;t++)if(k(r[t])){for(const n of Object.keys(r[t]))Gn(n)&&(k(e[n])&&k(r[t][n])?se(e[n],r[t][n]):e[n]=r[t][n]);Kn(e,r[t])}return e}const ce=({images:e=[],options:r})=>{r=se(r,{inline:!1});const t=document.createElement("div"),n=v.h("div",{style:{display:"none"},class:["__viewer-token"]},e.map(s=>v.h("img",typeof s=="string"?{src:s}:s)));v.render(n,t);const i=t.firstElementChild;document.body.appendChild(i);const c=new m.default(i,r),u=c.destroy.bind(c);return c.destroy=function(){return u(),v.render(null,t),c},c.show(),i.addEventListener("hidden",function(){this.viewer===c&&c.destroy()}),c};var qn=P,Hn=function(){return qn.Date.now()},Jn=Hn,Xn=/\s/;function zn(e){for(var r=e.length;r--&&Xn.test(e.charAt(r)););return r}var Qn=zn,Yn=Qn,Zn=/^\s+/;function ei(e){return e&&e.slice(0,Yn(e)+1).replace(Zn,"")}var ri=ei,ti=x,ni=E,ii="[object Symbol]";function ai(e){return typeof e=="symbol"||ni(e)&&ti(e)==ii}var oi=ai,si=ri,ue=w,ci=oi,fe=0/0,ui=/^[-+]0x[0-9a-f]+$/i,fi=/^0b[01]+$/i,di=/^0o[0-7]+$/i,li=parseInt;function vi(e){if(typeof e=="number")return e;if(ci(e))return fe;if(ue(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ue(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=si(e);var t=fi.test(e);return t||di.test(e)?li(e.slice(2),t?2:8):ui.test(e)?fe:+e}var yi=vi,bi=w,F=Jn,de=yi,pi="Expected a function",gi=Math.max,$i=Math.min;function mi(e,r,t){var n,i,c,u,s,d,o=0,T=!1,a=!1,l=!0;if(typeof e!="function")throw new TypeError(pi);r=de(r)||0,bi(t)&&(T=!!t.leading,a="maxWait"in t,c=a?gi(de(t.maxWait)||0,r):c,l="trailing"in t?!!t.trailing:l);function p(y){var $=n,S=i;return n=i=void 0,o=y,u=e.apply(S,$),u}function g(y){return o=y,s=setTimeout(j,r),T?p(y):u}function _(y){var $=y-d,S=y-o,ye=r-$;return a?$i(ye,c-S):ye}function h(y){var $=y-d,S=y-o;return d===void 0||$>=r||$<0||a&&S>=c}function j(){var y=F();if(h(y))return M(y);s=setTimeout(j,_(y))}function M(y){return s=void 0,l&&n?p(y):(n=i=void 0,u)}function N(){s!==void 0&&clearTimeout(s),o=0,n=d=i=s=void 0}function Ii(){return s===void 0?u:M(F())}function R(){var y=F(),$=h(y);if(n=arguments,i=this,d=y,$){if(s===void 0)return g(d);if(a)return clearTimeout(s),s=setTimeout(j,r),p(d)}return s===void 0&&(s=setTimeout(j,r)),u}return R.cancel=N,R.flush=Ii,R}var wi=mi;const le=({name:e="viewer",debug:r=!1}={})=>{async function t(a,l,p=!1,g=!1){await v.nextTick(),!(g&&!n(a))&&(p||!a[`$${e}`]?(u(a),a[`$${e}`]=new m.default(a,l),o("Viewer created")):(a[`$${e}`].update(),o("Viewer updated")))}function n(a){const l=a.innerHTML.match(/<img([\w\W]+?)[\\/]?>/g),p=l?l.join(""):void 0;return a.__viewerImageDiffCache===p?(o("Element change detected, but image(s) has not changed"),!1):(o("Image change detected"),a.__viewerImageDiffCache=p,!0)}function i(a,l,p,g){s(a);const _=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(!_){o("Observer not supported");return}const h=new _(M=>{M.forEach(N=>{o(`Viewer mutation:${N.type}`),p(a,l,g,!0)})}),j={attributes:!0,childList:!0,characterData:!0,subtree:!0};h.observe(a,j),a.__viewerMutationObserver=h,o("Observer created")}function c(a,l,p,g){a.__viewerUnwatch=v.watch(()=>l.value,(_,h)=>{o("Change detected by watcher: ",l.value),g(a,_,!0,!1)},{deep:!0}),o("Watcher created, expression: ",l.value)}function u(a){!a[`$${e}`]||(a[`$${e}`].destroy(),delete a[`$${e}`],o("Viewer destroyed"))}function s(a){!a.__viewerMutationObserver||(a.__viewerMutationObserver.disconnect(),delete a.__viewerMutationObserver,o("observer destroyed"))}function d(a){!a.__viewerUnwatch||(a.__viewerUnwatch(),delete a.__viewerUnwatch,o("Watcher destroyed"))}function o(...a){r&&console.log(...a)}return{mounted(a,l,p){o("Viewer bind");const g=wi(t,50);g(a,l.value),c(a,l,p,g),l.modifiers.static||i(a,l.value,g,l.modifiers.rebuild)},unmounted(a){o("Viewer unbind"),s(a),d(a),u(a)}}};var Ti=(e,r)=>{const t=e.__vccOpts||e;for(const[n,i]of r)t[n]=i;return t};const _i=v.defineComponent({name:"Viewer",props:{images:{type:Array,default:()=>[]},rebuild:{type:Boolean,default:!1},trigger:{type:Object,default:null},options:{type:Object,default:()=>null}},emits:["inited"],setup(e,{emit:r}){let t;const n=v.ref();function i(){t=new m.default(n.value,e.options),r("inited",t)}function c(){t&&t.destroy()}function u(){c(),i()}function s(){t?(t.update(),r("inited",t)):i()}function d(){e.rebuild?u():s()}const o={deep:!0};return v.watch(()=>e.images,()=>v.nextTick(()=>d()),o),v.watch(()=>e.trigger,()=>v.nextTick(()=>d()),o),v.watch(()=>e.options,()=>v.nextTick(()=>u()),o),v.onMounted(()=>i()),v.onUnmounted(()=>c()),{root:n,createViewer:i,rebuildViewer:u,updateViewer:s,destroyViewer:c}}}),hi={ref:"root"};function ji(e,r,t,n,i,c){return v.openBlock(),v.createElementBlock("div",hi,[v.renderSlot(e.$slots,"default",{images:e.images,options:e.options})],512)}var ve=Ti(_i,[["render",ji]]),Oi={install(e,{name:r="viewer",debug:t=!1,defaultOptions:n}={}){n&&m.default.setDefaults(n),e.config.globalProperties[`$${r}Api`]=ce,e.component(r,Rn(ve,{name:r})),e.directive(r,le({name:r,debug:t}))},setDefaults(e){m.default.setDefaults(e)}};Object.defineProperty(b,"Viewer",{enumerable:!0,get:function(){return m.default}}),b.api=ce,b.component=ve,b.default=Oi,b.directive=le,Object.defineProperty(b,"__esModule",{value:!0}),b[Symbol.toStringTag]="Module"});
